server {
    listen 80;
    server_name _;

    root /var/www/html;
    index index.php index.html index.htm;

    access_log /dev/stdout;
    error_log /dev/stdout info;

    location / {
        try_files $uri /index.php$is_args$args;
    }

    location ~ ^/index\.php(/|$) {
        fastcgi_pass unix:/var/run/php-fpm.sock;
        fastcgi_split_path_info ^(.+\.php)(/.*)$;
        include fastcgi_params;

        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
        fastcgi_param DOCUMENT_ROOT   $realpath_root;

        # Pass through auth headers you need
        fastcgi_param HTTP_AUTHORIZATION $http_authorization;
        fastcgi_param HTTP_X_API_KEY     $http_x_api_key;

        # Authoritative forwarded headers (DO NOT use $http_x_forwarded_*)
        fastcgi_param HTTP_HOST             $host;
        fastcgi_param SERVER_NAME           $host;
        fastcgi_param HTTP_X_FORWARDED_PROTO $scheme;
        fastcgi_param HTTP_X_FORWARDED_HOST  $host;
        fastcgi_param HTTP_X_FORWARDED_PORT  $server_port;
        fastcgi_param HTTP_X_FORWARDED_FOR   $proxy_add_x_forwarded_for;
    }

    location ~ \.php$ {
        return 404;
    }

    location /.git { deny all; return 403; }
    location ~ /\. { deny all; log_not_found off; }
    location ^~ /.well-known { allow all; auth_basic off; }
}